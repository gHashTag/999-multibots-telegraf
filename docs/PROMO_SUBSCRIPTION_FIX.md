# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–º–æ-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∫–∏

## –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –ø—Ä–æ–º–æ-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –±—ã–ª–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞:

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–ª –ø—Ä–æ–º–æ-–∑–≤–µ–∑–¥—ã** (476 –∑–≤–µ–∑–¥ —á–µ—Ä–µ–∑ `/start promo`)
2. **–ó–≤–µ–∑–¥—ã –Ω–∞—á–∏—Å–ª—è–ª–∏—Å—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** –≤ –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. **–ù–æ —Å–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–ª–∞ –Ω–∞ –æ–ø–ª–∞—Ç—É** –≤–º–µ—Å—Ç–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ—É–Ω–∫—Ü–∏—è–º
4. **–ü—Ä–∏—á–∏–Ω–∞**: –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –±—ã–ª–æ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, —Ö–æ—Ç—è —É –Ω–µ–≥–æ –±—ã–ª–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤–µ–∑–¥

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### –õ–æ–≥–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã –ø–æ–¥–ø–∏—Å–æ–∫

–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —Å–ª–µ–¥—É—é—â–µ–º—É –ø—Ä–∏–Ω—Ü–∏–ø—É:
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏** - —Å–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç –∞–∫—Ç–∏–≤–Ω—É—é –ø–æ–¥–ø–∏—Å–∫—É –≤ —Ç–∞–±–ª–∏—Ü–µ `payments_v2`
2. **–ï—Å–ª–∏ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–µ—Ç** - –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ `subscriptionScene` (–Ω–∞ –æ–ø–ª–∞—Ç—É)
3. **–ï—Å–ª–∏ –ø–æ–¥–ø–∏—Å–∫–∞ –µ—Å—Ç—å** - –¥–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏—è–º –±–æ—Ç–∞

### –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø—Ä–æ–º–æ-–∑–≤–µ–∑–¥–∞–º–∏

–ü—Ä–æ–º–æ-—Å–∏—Å—Ç–µ–º–∞ —Ç–æ–ª—å–∫–æ **–Ω–∞—á–∏—Å–ª—è–ª–∞ –∑–≤–µ–∑–¥—ã**, –Ω–æ **–Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª–∞ –ø–æ–¥–ø–∏—Å–∫—É**:

```typescript
// ‚ùå –ë–´–õ–û: –¢–æ–ª—å–∫–æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –∑–≤–µ–∑–¥
await directPaymentProcessor({
  type: PaymentType.MONEY_INCOME,
  category: 'BONUS',
  // –ù–µ—Ç subscription_type!
})
```

## –†–µ—à–µ–Ω–∏–µ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∫–∏

–û–±–Ω–æ–≤–ª–µ–Ω `PromoConfig` –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:

```typescript
export interface PromoConfig {
  defaultTier: SubscriptionType
  customStars?: number
  promoType: string
  autoActivateSubscription?: boolean // ‚úÖ –ù–û–í–û–ï
}

export const DEFAULT_PROMO_CONFIG: PromoConfig = {
  defaultTier: SubscriptionType.NEUROPHOTO,
  promoType: 'welcome_bonus',
  autoActivateSubscription: true, // ‚úÖ –í–∫–ª—é—á–µ–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
}
```

### 2. –õ–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏

–î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `autoActivateSubscriptionIfEligible`:

```typescript
async function autoActivateSubscriptionIfEligible(
  telegram_id: string,
  tier: SubscriptionType,
  bot_name: string
): Promise<void> {
  // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —É–∂–µ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏
  // 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ –∑–≤–µ–∑–¥ –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏
  // 3. –ï—Å–ª–∏ –¥–∞ - —Å–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å –æ –ø–æ–¥–ø–∏—Å–∫–µ –≤ –ë–î
}
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω directPaymentProcessor

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `subscription_type`:

```typescript
export interface DirectPaymentParams {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  subscription_type?: string // ‚úÖ –ù–û–í–û–ï
}

// –í –ª–æ–≥–∏–∫–µ –≤—Å—Ç–∞–≤–∫–∏:
const paymentInsertData = {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  subscription_type: subscription_type || null, // ‚úÖ –ù–û–í–û–ï
}
```

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°—Ü–µ–Ω–∞—Ä–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–æ-—Å—Å—ã–ª–∫–∏

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç** –ø–æ —Å—Å—ã–ª–∫–µ `https://t.me/MetaMuse_Manifest_bot?start=promo`

2. **–°–∏—Å—Ç–µ–º–∞ –Ω–∞—á–∏—Å–ª—è–µ—Ç –∑–≤–µ–∑–¥—ã**:
   ```
   üéÅ Promo bonus: 476 stars (BONUS category)
   ```

3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∞–∫—Ç–∏–≤–∞—Ü–∏–∏**:
   ```
   –ë–∞–ª–∞–Ω—Å: 476 –∑–≤–µ–∑–¥
   –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è NEUROPHOTO: 476 –∑–≤–µ–∑–¥
   ‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
   ```

4. **–°–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –æ –ø–æ–¥–ø–∏—Å–∫–µ**:
   ```typescript
   await directPaymentProcessor({
     type: PaymentType.MONEY_OUTCOME,
     amount: 476,
     subscription_type: 'NEUROPHOTO',
     category: 'REAL',
     description: 'üéÅ Auto-activated subscription: NEUROPHOTO'
   })
   ```

5. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø** –∫ —Ñ—É–Ω–∫—Ü–∏—è–º –±–æ—Ç–∞ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –æ–ø–ª–∞—Ç—ã

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–∏—è

### ‚úÖ –ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ –ø—Ä–æ–º–æ-—Å—Å—ã–ª–∫–µ
- –ù–µ –Ω—É–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π

### ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –ª–æ–≥–∏–∫—É –ø–æ–¥–ø–∏—Å–æ–∫
- –ó–∞–ø–∏—Å–∏ –≤ –ë–î —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –æ–±—ã—á–Ω—ã–º –ø–æ–¥–ø–∏—Å–∫–∞–º
- –†–∞–±–æ—Ç–∞–µ—Ç —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞

### ‚úÖ –ì–∏–±–∫–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –ú–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∞–∫—Ç–∏–≤–∞—Ü–∏—é: `autoActivateSubscription: false`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏—Ä–æ–≤ –ø–æ–¥–ø–∏—Å–æ–∫
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —Å—É–º–º—ã –∑–≤–µ–∑–¥

### ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏ –±–∞–ª–∞–Ω—Å–∞
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–æ–∫
- –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

1. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–º–æ** - –∞–≤—Ç–æ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
2. **–†–∞—Å—á–µ—Ç –∑–≤–µ–∑–¥** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å—É–º–º—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏—Ä–∞
3. **–õ–æ–≥–∏–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫** - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –∏ —Å—É–º–º
4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

```bash
‚úì 21 pass, 0 fail (57 expect() calls)
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –ü—Ä–æ–º–æ-—Å—Å—ã–ª–∫–∞ ‚Üí –ü–æ–ª—É—á–∞–µ—Ç –∑–≤–µ–∑–¥—ã ‚Üí –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –æ–ø–ª–∞—Ç—É ‚ùå
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –ü—Ä–æ–º–æ-—Å—Å—ã–ª–∫–∞ ‚Üí –ü–æ–ª—É—á–∞–µ—Ç –∑–≤–µ–∑–¥—ã ‚Üí –ê–≤—Ç–æ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ ‚Üí –î–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏—è–º ‚úÖ
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–º–æ-–∫–∞–º–ø–∞–Ω–∏–π

### –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–º–æ (NEUROPHOTO):
```typescript
const basicPromo = {
  defaultTier: SubscriptionType.NEUROPHOTO,
  promoType: 'welcome_bonus',
  autoActivateSubscription: true
}
// –†–µ–∑—É–ª—å—Ç–∞—Ç: 476 –∑–≤–µ–∑–¥ + –∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ NEUROPHOTO
```

### –ü—Ä–µ–º–∏—É–º –ø—Ä–æ–º–æ (NEUROVIDEO):
```typescript
const premiumPromo = {
  defaultTier: SubscriptionType.NEUROVIDEO,
  promoType: 'video_bonus',
  autoActivateSubscription: true
}
// –†–µ–∑—É–ª—å—Ç–∞—Ç: 1303 –∑–≤–µ–∑–¥—ã + –∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ NEUROVIDEO
```

### –¢–æ–ª—å–∫–æ –∑–≤–µ–∑–¥—ã (–±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏):
```typescript
const starsOnlyPromo = {
  defaultTier: SubscriptionType.NEUROPHOTO,
  promoType: 'stars_bonus',
  autoActivateSubscription: false
}
// –†–µ–∑—É–ª—å—Ç–∞—Ç: 476 –∑–≤–µ–∑–¥ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º –≤—ã–±–∏—Ä–∞–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É)
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞. –ü—Ä–æ–º–æ-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –∑–∞–¥—É–º–∞–Ω–æ:
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø** —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ –ø—Ä–æ–º–æ-—Å—Å—ã–ª–∫–µ
- **–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É** –ø—Ä–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–º –±–∞–ª–∞–Ω—Å–µ
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π
- **–î–æ–±–∞–≤–ª–µ–Ω–∞ –≥–∏–±–∫–æ—Å—Ç—å** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø—Ä–æ–º–æ-–∫–∞–º–ø–∞–Ω–∏–π

–ü—Ä–æ–º–æ-—Å—Å—ã–ª–∫–∞ `https://t.me/MetaMuse_Manifest_bot?start=promo` —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏—è–º –±–æ—Ç–∞. 