---
description:
globs:
alwaysApply: false
---
# üïâÔ∏è –¢–µ–∫—É—â–∞—è –ó–∞–¥–∞—á–∞: –ê–Ω–∞–ª–∏–∑ –∏ –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –°—Ç–æ–∏–º–æ—Å—Ç–∏ –í–∏–¥–µ–æ-–ú–æ–¥–µ–ª–µ–π

**–°—Ç–∞—Ç—É—Å:** ‚úèÔ∏è –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω, –æ–∂–∏–¥–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è –ì—É—Ä—É

**–¶–µ–ª—å:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å—Ç–æ–∏–º–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–∏–¥–µ–æ, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–∞—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Kling v1.6 Pro (76 ‚≠ê)"), –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É.

**–ü—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏—è:** –ì—É—Ä—É –≤—ã—Ä–∞–∑–∏–ª —Å–æ–º–Ω–µ–Ω–∏–µ –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π "—Ü–µ–Ω—ã", —Å—Ä–∞–≤–Ω–∏–≤–∞—è –µ–µ —Å –æ–±—â–∏–º–∏ —Ç—Ä–∞—Ç–∞–º–∏.

**–ê–Ω–∞–ª–∏–∑ –∏ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

1.  ‚úÖ **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è `basePrice` –¥–ª—è `kwaivgi/kling-v1.6-pro`:**
    *   –î–∞–Ω–Ω—ã–µ –∏–Ω–≤–æ–π—Å–∞ Replicate –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏: —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ü–µ–Ω–∞ –æ—Ç Replicate —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç **$0.098 –∑–∞ —Å–µ–∫—É–Ω–¥—É —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤–∏–¥–µ–æ**.
    *   `basePrice` –≤ `VIDEO_MODELS_CONFIG` —É–∂–µ –±—ã–ª–∞ $0.098, —á—Ç–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

2.  ‚úÖ **–ê–Ω–∞–ª–∏–∑ –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –¢–µ–∫—Å—Ç–∞ –ö–Ω–æ–ø–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Kling v1.6 Pro (76 ‚≠ê)")**:
    *   –¢–µ–∫—Å—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –≤ —Å—Ü–µ–Ω–µ `src/scenes/imageToVideoWizard/index.ts`.
    *   –ß–∏—Å–ª–æ –≤ —Å–∫–æ–±–∫–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, 76) ‚Äì —ç—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ `calculateFinalPrice(modelKey)` –∏–∑ `src/price/helpers/calculateFinalPrice.ts`.
    *   –ó–≤–µ–∑–¥–æ—á–∫–∞ "‚≠ê" –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Ö–∞—Ä–¥–∫–æ–¥–æ–º –≤ —Å—Ü–µ–Ω–µ.

3.  ‚úÖ **–ê–Ω–∞–ª–∏–∑ –õ–æ–≥–∏–∫–∏ `calculateFinalPrice`:**
    *   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `modelConfig.basePrice` (–Ω–∞–ø—Ä–∏–º–µ—Ä, $0.098 –¥–ª—è Kling Pro).
    *   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `DEFAULT_VIDEO_DURATION_SECONDS = 5` (—Ç.–µ. —Ä–∞—Å—á–µ—Ç –∏–¥–µ—Ç –¥–ª—è 5-—Å–µ–∫—É–Ω–¥–Ω–æ–≥–æ –≤–∏–¥–µ–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).
    *   `totalBaseCostUSD = basePrice * 5` (–¥–ª—è Kling Pro: $0.098 * 5 = $0.49).
    *   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `SYSTEM_CONFIG.starCost` (—Å—Ç–æ–∏–º–æ—Å—Ç—å 1 –∑–≤–µ–∑–¥—ã –≤ USD) –∏–∑ `src/price/constants/index.ts`.
        *   `starCost = 0.016` ($0.016 –∑–∞ –∑–≤–µ–∑–¥—É).
    *   `basePriceInStars = totalBaseCostUSD / starCost` (–¥–ª—è Kling Pro: $0.49 / $0.016 ‚âà 30.625 –∑–≤–µ–∑–¥).
    *   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `SYSTEM_CONFIG.interestRate` (–Ω–∞—Ü–µ–Ω–∫–∞) –∏–∑ `src/price/constants/index.ts`.
        *   `interestRate = 1.5` (–Ω–∞—Ü–µ–Ω–∫–∞ 150%, —Ç.–µ. —É–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ 2.5).
    *   `finalPriceWithMarkup = basePriceInStars * (1 + interestRate)` (–¥–ª—è Kling Pro: 30.625 * 2.5 ‚âà 76.5625 –∑–≤–µ–∑–¥).
    *   `finalPriceInStars = Math.floor(finalPriceWithMarkup)` (–¥–ª—è Kling Pro: `Math.floor(76.5625) = 76` –∑–≤–µ–∑–¥).

4.  ‚úÖ **–í—ã–≤–æ–¥ –ø–æ "Kling v1.6 Pro (76 ‚≠ê)":**
    *   –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ **76 –∑–≤–µ–∑–¥ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** —Å–æ–≥–ª–∞—Å–Ω–æ —Ç–µ–∫—É—â–µ–π –ª–æ–≥–∏–∫–µ.
    *   –û–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏ 5-—Å–µ–∫—É–Ω–¥–Ω–æ–≥–æ –≤–∏–¥–µ–æ ($0.49) + –∫—É—Ä—Å –∑–≤–µ–∑–¥—ã ($0.016/–∑–≤–µ–∑–¥–∞) + –Ω–∞—Ü–µ–Ω–∫–∞ (150%).
    *   –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–∞—è —Ü–µ–Ω–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –æ–Ω –ø–æ–∫—É–ø–∞–µ—Ç –∑–≤–µ–∑–¥—ã –ø–æ $0.016): 76 –∑–≤–µ–∑–¥ * $0.016 = **$1.216** –∑–∞ 5-—Å–µ–∫—É–Ω–¥–Ω–æ–µ –≤–∏–¥–µ–æ (–ø—Ä–∏ —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏ $0.49).

**–¢–µ–∫—É—â–∞—è –°–∏—Ç—É–∞—Ü–∏—è:**
*   –ù–µ—Å–æ—Å—Ç—ã–∫–æ–≤–∫–∞, –∫–æ—Ç–æ—Ä—É—é –æ—â—É—â–∞–ª –ì—É—Ä—É, –≤–µ—Ä–æ—è—Ç–Ω–æ, –±—ã–ª–∞ —Å–≤—è–∑–∞–Ω–∞ —Å –Ω–µ–ø–æ–Ω–∏–º–∞–Ω–∏–µ–º, —á—Ç–æ "76" - —ç—Ç–æ –∑–≤–µ–∑–¥—ã, —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–µ –¥–ª—è 5-—Å–µ–∫—É–Ω–¥–Ω–æ–≥–æ –≤–∏–¥–µ–æ —Å —É—á–µ—Ç–æ–º –∫—É—Ä—Å–∞ –∏ –±–æ–ª—å—à–æ–π –Ω–∞—Ü–µ–Ω–∫–∏, –∞ –Ω–µ –ø—Ä—è–º–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤ —Ü–µ–Ω—Ç–∞—Ö –∏–ª–∏ –¥–æ–ª–ª–∞—Ä–∞—Ö –∑–∞ —Å–µ–∫—É–Ω–¥—É.
*   –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏, —Ä–∞—Å—á–µ—Ç —Ü–µ–Ω—ã –≤ –∑–≤–µ–∑–¥–∞—Ö –≤–µ—Ä–µ–Ω –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∑–∞–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

**‚è≥ –°–ª–µ–¥—É—é—â–∏–µ –®–∞–≥–∏ (–¢—Ä–µ–±—É–µ—Ç—Å—è –†–µ—à–µ–Ω–∏–µ –ì—É—Ä—É):**

1.  **–ì—É—Ä—É –¥–æ–ª–∂–µ–Ω —Ä–µ—à–∏—Ç—å, —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ª–∏ –µ–≥–æ —Ç–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —ç–∫–æ–Ω–æ–º–∏–∫–∞:**
    *   **–í–∞—Ä–∏–∞–Ω—Ç 1: –û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å.** (–°–∏—Å—Ç–µ–º–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞).
    *   **–í–∞—Ä–∏–∞–Ω—Ç 2: –ò–∑–º–µ–Ω–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –±–æ–ª–µ–µ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.**
        *   –ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ü–µ–Ω—É –≤ USD –∑–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –≤–∏–¥–µ–æ ("$1.22 –∑–∞ 5 —Å–µ–∫").
        *   –ò–ª–∏ —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å + –ø–æ—è—Å–Ω–µ–Ω–∏–µ –æ –Ω–∞—Ü–µ–Ω–∫–µ/–∑–≤–µ–∑–¥–∞—Ö.
    *   **–í–∞—Ä–∏–∞–Ω—Ç 3: –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å —ç–∫–æ–Ω–æ–º–∏–∫—É "–∑–≤–µ–∑–¥".**
        *   –£–º–µ–Ω—å—à–∏—Ç—å `SYSTEM_CONFIG.interestRate` (–Ω–∞—Ü–µ–Ω–∫—É).
        *   –ò–∑–º–µ–Ω–∏—Ç—å `SYSTEM_CONFIG.starCost` (–∫—É—Ä—Å –∑–≤–µ–∑–¥—ã).

2.  **–ù–µ–π—Ä–æ–ö–æ–¥–µ—Ä:** –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ—à–µ–Ω–∏—è –ì—É—Ä—É, –≤–Ω–µ—Å—Ç–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥ (–≤ `calculateFinalPrice.ts`, `src/scenes/imageToVideoWizard/index.ts`, `src/price/constants/index.ts` –∏/–∏–ª–∏ –¥—Ä—É–≥–∏–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã).
