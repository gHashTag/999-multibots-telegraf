#!/bin/bash

# –¢–æ–∫–µ–Ω—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
TOKENS=(
  "6950844437:AAFnSoX01iXljaNxmsPojm7Cw5CJqw1O3qY"  # –¢–µ–∫—É—â–∏–π —Ç–æ–∫–µ–Ω
  "6950844437:AAFnSoX01iXljaNxmsPojm7Cw5CJqw1O3qY"  # –¢–æ–∫–µ–Ω —Å –¥—Ä—É–≥–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π
  "5662522862:AAH7yTQVZd9aBpDIGCXK_aTVx7QeXTABKK0"  # –¢–æ–∫–µ–Ω @BotFather
)

CHAT_ID="144022504"  # ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

echo "=== –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –±–æ—Ç–∞ ==="

for token in "${TOKENS[@]}"; do
  echo "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞: $token"
  
  # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ—Ç–µ
  bot_info=$(curl -s "https://api.telegram.org/bot$token/getMe")
  echo "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ: $bot_info"
  
  # –ï—Å–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ, –ø—Ä–æ–±—É–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
  if echo "$bot_info" | grep -q '"ok":true'; then
    echo "‚úÖ –¢–æ–∫–µ–Ω –≤–∞–ª–∏–¥–Ω—ã–π"
    
    # –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    message="üîç –¢–µ—Å—Ç —Ç–æ–∫–µ–Ω–∞ –±–æ—Ç–∞\n–í—Ä–µ–º—è: $(date "+%Y-%m-%d %H:%M:%S")\n–≠—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ API"
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    send_result=$(curl -s -X POST "https://api.telegram.org/bot$token/sendMessage" \
                -d "chat_id=$CHAT_ID" \
                -d "text=$message")
    
    echo "–†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏: $send_result"
    
    if echo "$send_result" | grep -q '"ok":true'; then
      echo "‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!"
      echo "–†–ê–ë–û–ß–ò–ô –¢–û–ö–ï–ù: $token"
      echo
      
      # –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–∫–µ–Ω –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö
      echo "–û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–∫–µ–Ω –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö..."
      sed -i "s|BOT_TOKEN=\"[^\"]*\"|BOT_TOKEN=\"$token\"|g" /root/admin-pulse-notify.sh
      sed -i "s|BOT_TOKEN=\"[^\"]*\"|BOT_TOKEN=\"$token\"|g" /root/test-pulse-messages.sh
      
      echo "–¢–æ–∫–µ–Ω –æ–±–Ω–æ–≤–ª–µ–Ω –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö."
      break
    else
      echo "‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è"
    fi
  else
    echo "‚ùå –ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω"
  fi
  
  echo "-------------------------------"
done

echo
echo "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ." 