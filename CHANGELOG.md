# CHANGELOG

## [2023-06-06]

### Added
- Добавлены тесты для функции createSuccessfulPayment:
  - Тест успешного создания платежа
  - Тест обработки дублирующихся платежей с одинаковым inv_id
  - Тест обработки платежей для несуществующих пользователей
  - Тест проверки существования платежа по inv_id

### Fixed
- Улучшена функция createSuccessfulPayment:
  - Добавлена проверка на существующий inv_id для предотвращения дублирования платежей
  - Добавлено возвращение существующего платежа вместо создания дубликата

## [2023-06-05]

### Added
- Интеграция с платежной системой для SelectModelWizard
- Поддержка платных моделей с визуальной маркировкой
- Система подтверждения выбора платной модели
- Тесты для платежной интеграции с SelectModelWizard

### Fixed
- Улучшена обработка ошибок при недостаточном балансе
- Исправлена типизация платежных параметров

### Changed
- Обновлена документация по платежной системе
- Улучшен пользовательский интерфейс выбора модели
- Добавлены эмодзи-индикаторы для платных моделей
- Расширены тестовые сценарии для платежной системы

## [2023-04-10]

### Added
- Initial commit
- Basic telegram bot functionality
- Base payment structure

## [Unreleased]

### Fixed
- Исправлен расчет баланса пользователя: теперь функция `get_user_balance` использует тот же алгоритм, что и `get_user_balance_stats`, включая учет системных транзакций. Это устраняет несоответствие между отображаемыми значениями баланса в разных частях приложения.
- Исправлена ошибка линтера в `src/test-utils/tests/payment/paymentProcessorMockTest.ts` - удален неиспользуемый импорт `inngestTestEngine`.

### Added
- Добавлена документация по конфигурации Nginx:
  - Создан файл `docs/NGINX-CONFIG.md` с подробным описанием структуры конфигурации Nginx в проекте
  - Добавлен раздел о конфигурации Nginx в `README.md`
  - Добавлено описание всех используемых файлов конфигурации и их назначения для разных сред (разработка, тестирование, продакшн) 