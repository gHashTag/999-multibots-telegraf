# üïâÔ∏è –ò—Å—Ç–æ—Ä–∏—è –£—Å–ø–µ—Ö–∞: –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –°—Ç–∞–±–∏–ª—å–Ω—ã–µ –°–æ—Å—Ç–æ—è–Ω–∏—è

–≠—Ç–æ—Ç —Ñ–∞–π–ª —Ö—Ä–∞–Ω–∏—Ç –æ–ø–∏—Å–∞–Ω–∏—è —É—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–µ–π –∏–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π. **–ö–ª—é—á–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ - —Ö–µ—à –∫–æ–º–º–∏—Ç–∞ (`git commit`)**, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –¥–∞–Ω–Ω–æ–º—É —Å—Ç–∞–±–∏–ª—å–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é (—Ä–µ–ø–µ—Ä–Ω–∞—è —Ç–æ—á–∫–∞). –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–æ—á–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –∫–æ–¥–∞.

**–¶–µ–ª—å:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–π –∏ –±—ã—Å—Ç—Ä—ã–π, –Ω–∞–¥–µ–∂–Ω—ã–π –æ—Ç–∫–∞—Ç –∫ –∏–∑–≤–µ—Å—Ç–Ω–æ–º—É —Ä–∞–±–æ—á–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é —Å –ø–æ–º–æ—â—å—é `git reset --hard <commit_hash>`.

---

## –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –ù–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ –û–±—Ä–∞–±–æ—Ç–∫–∏ –ö–Ω–æ–ø–æ–∫ (–ê–ø—Ä–µ–ª—å 2025)

*   **–î–∞—Ç–∞ –§–∏–∫—Å–∞—Ü–∏–∏:** 2025-04-30
*   **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –∫–æ–º–∞–Ω–¥—ã `/menu` –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö/—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–¶–∏—Ñ—Ä–æ–≤–æ–µ —Ç–µ–ª–æ", "–û—Ç–º–µ–Ω–∞") –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ middleware –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –≤ `src/registerCommands.ts`.
*   **–ö–ª—é—á–µ–≤–æ–π –ü–∞—Ç—Ç–µ—Ä–Ω –£—Å–ø–µ—Ö–∞:**
    *   **–ü–æ—Ä—è–¥–æ–∫ –≤ `src/registerCommands.ts`:**
        1.  –õ–æ–≥–≥–µ—Ä (`bot.use(...)`)
        2.  –°–µ—Å—Å–∏—è (`bot.use(session(...))`).
        3.  Middleware —Å—Ü–µ–Ω (`bot.use(stage.middleware())`).
        4.  **–í—Å–µ** –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (`hears`, `action`, `command`), –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–µ–Ω `ctx.session` –∏–ª–∏ `ctx.scene`.
        5.  –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∫–æ–ª–±—ç–∫–æ–≤ (`bot.on(callbackQuery('data'), ...)`).
        6.  –û–±—â–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–µ–∫—Å—Ç–∞ –≤ –°–ê–ú–û–ú –ö–û–ù–¶–ï (`bot.on(message('text'), handleTextMessage)`).
*   **–†–µ–ø–µ—Ä–Ω—ã–π –ö–æ–º–º–∏—Ç (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û):** `2e110b78` (`feat: Stabilize middleware/handler order for reliable navigation`)
*   **–°–≤—è–∑–∞–Ω–Ω—ã–π `current_task.mdc`:** –ó–∞–ø–∏—Å—å "–û—Ç–ª–∞–¥–∫–∞, –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –ù–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ –§–∏–∫—Å–∞—Ü–∏—è –†–µ–ø–µ—Ä–Ω–æ–π –¢–æ—á–∫–∏".

---

## –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ì–µ–Ω–µ—Ä–∞—Ü–∏–∏ Text-to-Image (–ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤) (–ú–∞–π 2025)

*   **–î–∞—Ç–∞ –§–∏–∫—Å–∞—Ü–∏–∏:** 2025-05-03
*   **–ü—Ä–æ–±–ª–µ–º–∞/–ó–∞–¥–∞—á–∞:** –£—Å—Ç—Ä–∞–Ω–∏—Ç—å –±–∞–≥ —Å –¥–≤–æ–π–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π (4->8 —Ñ–æ—Ç–æ) –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —á–µ—Ä–µ–∑ API –±—ç–∫–µ–Ω–¥–∞. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –¥–ª—è –ø—Ä—è–º–æ–≥–æ –≤—ã–∑–æ–≤–∞ `replicate` –∏–∑ –∫–æ–¥–∞ –±–æ—Ç–∞. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –±–∞–≥–æ–≤ (–∫–æ–Ω—Ñ–ª–∏–∫—Ç –º–æ–¥–µ–ª–µ–π –≤ —Å–µ—Å—Å–∏–∏, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫, —Ü–µ–Ω–∞, pulse).
*   **–ö–ª—é—á–µ–≤–æ–π –ü–∞—Ç—Ç–µ—Ä–Ω –£—Å–ø–µ—Ö–∞:**
    *   –°–æ–∑–¥–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `generateTextToImageDirect` –¥–ª—è –ø—Ä—è–º–æ–≥–æ –≤—ã–∑–æ–≤–∞ `replicate`.
    *   –°—Ü–µ–Ω—ã `textToImageWizard` –∏ `improvePromptWizard` –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –≤—ã–∑–æ–≤–∞ `generateTextToImageDirect`.
    *   –†–∞–∑–¥–µ–ª–µ–Ω–æ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –¥–ª—è —Ç–µ–∫—Å—Ç–∞ (`selectedModel`) –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (`selectedImageModel`) –≤ `ctx.session`.
    *   –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–Ω–æ–ø–æ–∫ –∏ –≤—ã—Ö–æ–¥–∞ –∏–∑ —Å—Ü–µ–Ω (`textToImageWizard`, `sizeWizard`, `improvePromptWizard`).
    *   –£—Å—Ç—Ä–∞–Ω–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ `shortName` –≤ `imageModelPrices.ts` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å–ø–∏—Å–∞–Ω–∏—è.
    *   –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `pulse` (–¥–æ–±–∞–≤–ª–µ–Ω `bot_name`).
*   **–†–µ–ø–µ—Ä–Ω—ã–π –ö–æ–º–º–∏—Ç:** `f155d2239f199712a485ac69d1a646c461063547` (–í–µ—Ç–∫–∞: `text-photo`)
*   **–°–≤—è–∑–∞–Ω–Ω—ã–π `current_task.mdc`:** –ó–∞–ø–∏—Å—å "Refactor text-to-image generation & Session Models".

---

**–î–∞—Ç–∞:** 2025-04-30
**–ü—Ä–æ–±–ª–µ–º–∞/–§—É–Ω–∫—Ü–∏—è:** –ö–Ω–æ–ø–∫–∞ "–û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É" –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞ –ø–æ—Å–ª–µ /start.
**–ü–∞—Ç—Ç–µ—Ä–Ω –£—Å–ø–µ—Ö–∞:** –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∞—Å—å —Å—Ü–µ–Ω–æ–π `startScene`, –∫–æ—Ç–æ—Ä–∞—è —Å—Ä–∞–∑—É –∑–∞–≤–µ—Ä—à–∞–ª–∞—Å—å (`ctx.scene.leave()`). –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –≤–Ω–µ –∞–∫—Ç–∏–≤–Ω–æ–π —Å—Ü–µ–Ω—ã. –†–µ—à–µ–Ω–∏–µ - –¥–æ–±–∞–≤–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `bot.hears([levels[105].title_ru, levels[105].title_en], ...)` –≤ `src/registerCommands.ts`, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –≤ `SubscriptionScene`.
**–†–µ–ø–µ—Ä–Ω—ã–π –ö–æ–º–º–∏—Ç:** `6ca05652`
**–°–≤—è–∑–∞–Ω–Ω–∞—è –ó–∞–¥–∞—á–∞:** `current-task.mdc` (–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ë–∞–≥–æ–≤ –ú–µ–Ω—é)

## –£—Å–ø–µ—à–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞ Kaya
- **–î–∞—Ç–∞**: 2025-01-03
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –£—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Ä—É—Å—Å–∫–∏–π (id=202) –∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π (id=201) –ø–µ—Ä–µ–≤–æ–¥—ã —Å—Ç–∞—Ä—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –±–æ—Ç–∞ Kaya_easy_art_bot —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —ç–º–æ–¥–∑–∏.
- **–ü–∞—Ç—Ç–µ—Ä–Ω —É—Å–ø–µ—Ö–∞**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `mcp_supabase_execute_sql` —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Å–∏–º–≤–æ–ª–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü—ã.
- **–ö–æ–º–º–∏—Ç**: –ë—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –ø–æ—Å–ª–µ —Ñ–∏–∫—Å–∞—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–í–µ—Ç–∫–∞: test-image-to-video)
- **–°—Å—ã–ª–∫–∞**: –¢–µ–∫—É—â–∞—è –∑–∞–¥–∞—á–∞ –≤ `current_task.mdc`.

## –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –°—Ç–æ–∏–º–æ—Å—Ç–∏ –ú–æ–¥–µ–ª–∏ Kling v1.6 Pro (Replicate)

*   **–î–∞—Ç–∞:** 2025-05-08
*   **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –±—ã–ª–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –æ—Ç–∫–∞–ª–∏–±—Ä–æ–≤–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–∏–¥–µ–æ –º–æ–¥–µ–ª—å—é `kwaivgi/kling-v1.6-pro`, —Ç–∞–∫ –∫–∞–∫ –º–µ—Ç–æ–¥ —Ä–∞—Å—á–µ—Ç–∞ —á–µ—Ä–µ–∑ –æ–±—â–∏–π –±–∞–ª–∞–Ω—Å –±—ã–ª –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω.
*   **–†–µ—à–µ–Ω–∏–µ:**
    1.  –ü—Ä–æ–≤–µ–¥–µ–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç (`src/__tests__/replicateKlingCost.test.ts`) –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.
    2.  –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ –∏–Ω–≤–æ–π—Å–∞ Replicate, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –ì—É—Ä—É.
    3.  –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, —á—Ç–æ –º–æ–¥–µ–ª—å —Ç–∞—Ä–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è **–∑–∞ —Å–µ–∫—É–Ω–¥—É —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤–∏–¥–µ–æ** (`type: video_output_duration_seconds`).
    4.  –§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ü–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É (`unit_cost`) –∏–∑ –∏–Ω–≤–æ–π—Å–∞ —Å–æ—Å—Ç–∞–≤–∏–ª–∞ **$0.098 / —Å–µ–∫ –≤–∏–¥–µ–æ**.
    5.  –≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–æ–≤–ø–∞–ª–æ —Å `basePrice`, —É–∂–µ —É–∫–∞–∑–∞–Ω–Ω—ã–º –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (`src/modules/videoGenerator/config/models.config.ts`).
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¶–µ–Ω–∞ $0.098 / —Å–µ–∫ –≤–∏–¥–µ–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞. –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ `basePrice` –Ω–µ –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–∞—Å—å.
    *   –°—Ç–æ–∏–º–æ—Å—Ç—å 5-—Å–µ–∫—É–Ω–¥–Ω–æ–≥–æ –≤–∏–¥–µ–æ: $0.49
    *   –°—Ç–æ–∏–º–æ—Å—Ç—å 10-—Å–µ–∫—É–Ω–¥–Ω–æ–≥–æ –≤–∏–¥–µ–æ: $0.98
*   **–ö–æ–º–º–∏—Ç:** (–ë—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –ø–æ—Å–ª–µ –∫–æ–º–º–∏—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
*   **–°–≤—è–∑–∞–Ω–Ω–∞—è –ó–∞–¥–∞—á–∞:** –ó–∞–ø–∏—Å—å –≤ `current_task.mdc` –æ—Ç 2025-05-08.

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ö–Ω–æ–ø–∫–∏ "–£–≤–µ–ª–∏—á–∏—Ç—å –ö–∞—á–µ—Å—Ç–≤–æ –§–æ—Ç–æ" (–Ø–Ω–≤–∞—Ä—å 2025)

*   **–î–∞—Ç–∞ –§–∏–∫—Å–∞—Ü–∏–∏:** 2025-01-14
*   **–ü—Ä–æ–±–ª–µ–º–∞:** –ö–Ω–æ–ø–∫–∞ "‚¨ÜÔ∏è –£–≤–µ–ª–∏—á–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ —Ñ–æ—Ç–æ" (level[107]) –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞ - –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –Ω–∏–∫–∞–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π.
*   **–ö–æ—Ä–µ–Ω—å –ü—Ä–æ–±–ª–µ–º—ã:** –í `hearsHandlers.ts` –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è `levels[107]`, —Ö–æ—Ç—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –±—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ `handleMenu.ts`. Telegram-–∫–Ω–æ–ø–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `bot.hears()`, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ actions –≤ `handleMenu.ts`.
*   **–ö–ª—é—á–µ–≤–æ–π –ü–∞—Ç—Ç–µ—Ä–Ω –£—Å–ø–µ—Ö–∞:**
    *   **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:** –î–ª—è –∫–∞–∂–¥–æ–≥–æ `levels[N]` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–∞–∫ –≤ `handleMenu.ts` (actions), —Ç–∞–∫ –∏ –≤ `hearsHandlers.ts` (bot.hears).
    *   **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `checkSubscriptionGuard()` –ø–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º –≤ –ø–ª–∞—Ç–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é.
    *   **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–µ–∂–∏–º–∞:** `ctx.session.mode = ModeEnum.ImageUpscaler` –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –≤ `CheckBalanceScene`.
*   **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –†–µ—à–µ–Ω–∏–µ:**
    ```typescript
    bot.hears(
      [levels[107].title_ru, levels[107].title_en],
      async (ctx: MyContext) => {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏ + —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–µ–∂–∏–º–∞ + –ø–µ—Ä–µ—Ö–æ–¥ –≤ —Å—Ü–µ–Ω—É
      }
    )
    ```
*   **–†–µ–ø–µ—Ä–Ω—ã–π –ö–æ–º–º–∏—Ç:** `f05e769` (–í–µ—Ç–∫–∞: `cursor/fix-quality-increase-button-issue-f939`)
*   **–°–≤—è–∑–∞–Ω–Ω–∞—è –ó–∞–¥–∞—á–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –±–∞–≥-—Ä–µ–ø–æ—Ä—Ç –ø–æ –∫–Ω–æ–ø–∫–µ —É–≤–µ–ª–∏—á–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞.

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¶–∏–∫–ª–∞ –î–∏–∞–ª–æ–≥–∞ –≤ –ß–∞—Ç–µ —Å –ê–≤–∞—Ç–∞—Ä–æ–º (–Ø–Ω–≤–∞—Ä—å 2025)

*   **–î–∞—Ç–∞ –§–∏–∫—Å–∞—Ü–∏–∏:** 2025-01-15
*   **–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–º–∞–Ω–¥–∞ "–ß–∞—Ç —Å –∞–≤–∞—Ç–∞—Ä–æ–º" —Ä–∞–±–æ—Ç–∞–ª–∞, –Ω–æ –±–æ—Ç –æ—Ç–≤–µ—á–∞–ª —Ç–æ–ª—å–∫–æ –Ω–∞ –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å.
*   **–ö–æ—Ä–µ–Ω—å –ü—Ä–æ–±–ª–µ–º—ã:**
    *   –í —Å—Ü–µ–Ω–µ `chatWithAvatarWizard` –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –±—ã–ª–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ –æ–∂–∏–¥–∞–Ω–∏—é —Å–ª–µ–¥—É—é—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.
    *   –í `registerCommands.ts` –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π `bot.on(message('text'), handleTextMessage)`.
*   **–ö–ª—é—á–µ–≤–æ–π –ü–∞—Ç—Ç–µ—Ä–Ω –£—Å–ø–µ—Ö–∞:**
    *   **–¶–∏–∫–ª–∏—á–Ω–æ—Å—Ç—å —Å—Ü–µ–Ω—ã:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `ctx.wizard.selectStep(1)` –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∞ –≤—Ç–æ—Ä–æ–π —à–∞–≥ —Å—Ü–µ–Ω—ã.
    *   **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ `bot.on(message('text'), handleTextMessage)` –≤ –∫–æ–Ω–µ—Ü `registerCommands`.
    *   **–ü–æ—Ä—è–¥–æ–∫ –≤–∞–∂–µ–Ω:** –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–µ–∫—Å—Ç–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–º, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã –∏ –∫–Ω–æ–ø–∫–∏.
    *   **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:** –°—Ü–µ–Ω–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–æ–π (`ModeEnum.ChatWithAvatar`), —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç `handleTextMessage` –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É.
*   **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –†–µ—à–µ–Ω–∏–µ:**
    ```typescript
    // –í –∫–æ–Ω—Ü–µ –≤—Ç–æ—Ä–æ–≥–æ —à–∞–≥–∞ chatWithAvatarWizard
    return ctx.wizard.selectStep(1)

    // –í –∫–æ–Ω—Ü–µ registerCommands
    bot.on(message('text'), handleTextMessage)
    ```
*   **–†–µ–ø–µ—Ä–Ω—ã–π –ö–æ–º–º–∏—Ç:** `93585a71ac56ab936999c8675bfa669d17ae7971`
*   **–°–≤—è–∑–∞–Ω–Ω–∞—è –ó–∞–¥–∞—á–∞:** –ü—Ä–æ–±–ª–µ–º–∞ —Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ —Å –∞–≤–∞—Ç–∞—Ä–æ–º

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏ –í–∏–¥–µ–æ (–ò—é–Ω—å 2025)

*   **–î–∞—Ç–∞ –§–∏–∫—Å–∞—Ü–∏–∏:** 2025-06-19
*   **–ü—Ä–æ–±–ª–µ–º–∞:** –§—É–Ω–∫—Ü–∏—è "üì∫ –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è Reels" –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞ - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥–ª–∏ –ø–æ–ª—É—á–∏—Ç—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—é –∏–∑ –≤–∏–¥–µ–æ Instagram Reels, TikTok –∏–ª–∏ YouTube Shorts.
*   **–ö–æ—Ä–µ–Ω—å –ü—Ä–æ–±–ª–µ–º—ã:**
    *   –í `checkBalanceScene.ts` –¥–ª—è —Ä–µ–∂–∏–º–∞ `VideoTranscription` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å—Ü–µ–Ω—ã.
    *   –ö–æ–¥ –ø—ã—Ç–∞–ª—Å—è –≤–æ–π—Ç–∏ –≤ `ModeEnum.VideoTranscription` –≤–º–µ—Å—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∏–º–µ–Ω–∏ —Å—Ü–µ–Ω—ã `'video_transcription'`.
    *   –°—Ü–µ–Ω–∞ `videoTranscriptionWizard` –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∫–∞–∫ `'video_transcription'`, –Ω–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ enum –∑–Ω–∞—á–µ–Ω–∏–µ.
*   **–ö–ª—é—á–µ–≤–æ–π –ü–∞—Ç—Ç–µ—Ä–Ω –£—Å–ø–µ—Ö–∞:**
    *   **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Å—Ü–µ–Ω:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–æ–≤–æ–≥–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ —Å—Ü–µ–Ω—ã –≤–º–µ—Å—Ç–æ enum –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è `ctx.scene.enter()`.
    *   **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å—Ü–µ–Ω:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∏–º—è —Å—Ü–µ–Ω—ã –≤ `new Scenes.WizardScene()` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∏–º–µ–Ω–∏ –≤ `ctx.scene.enter()`.
    *   **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è:** –°—Ü–µ–Ω—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å snake_case —Å—Ç—Ä–æ–∫–∏, –∞ –Ω–µ enum –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –≤—Ö–æ–¥–∞.
*   **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –†–µ—à–µ–Ω–∏–µ:**
    ```typescript
    // –ë—ã–ª–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
    await ctx.scene.enter(ModeEnum.VideoTranscription)

    // –°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
    await ctx.scene.enter('video_transcription')
    ```
*   **–†–µ–ø–µ—Ä–Ω—ã–π –ö–æ–º–º–∏—Ç:** `541289c4` (–í–µ—Ç–∫–∞: `upscale`)
*   **–°–≤—è–∑–∞–Ω–Ω–∞—è –ó–∞–¥–∞—á–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –±–∞–≥-—Ä–µ–ø–æ—Ä—Ç "–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ç–æ—Ä"

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Instagram Reels –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–ò—é–Ω—å 2025)

*   **–î–∞—Ç–∞ –§–∏–∫—Å–∞—Ü–∏–∏:** 2025-06-20
*   **–ü—Ä–æ–±–ª–µ–º–∞:** Instagram Reels –Ω–µ —Å–∫–∞—á–∏–≤–∞–ª–∏—Å—å —á–µ—Ä–µ–∑ yt-dlp –∏–∑-–∑–∞ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –û—à–∏–±–∫–∏: "rate-limit reached or login required", "Main webpage is locked behind the login page".
*   **–ö–æ—Ä–µ–Ω—å –ü—Ä–æ–±–ª–µ–º—ã:**
    *   Instagram —É–∂–µ—Å—Ç–æ—á–∏–ª –ø–æ–ª–∏—Ç–∏–∫—É –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω—Ç–µ–Ω—Ç—É, —Ç—Ä–µ–±—É—è cookies –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
    *   yt-dlp –Ω–µ –º–æ–≥ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –≤–∏–¥–µ–æ –±–µ–∑ –±—Ä–∞—É–∑–µ—Ä–Ω—ã—Ö cookies.
    *   –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫.
*   **–ö–ª—é—á–µ–≤–æ–π –ü–∞—Ç—Ç–µ—Ä–Ω –£—Å–ø–µ—Ö–∞:**
    *   **Cookies –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `--cookies-from-browser chrome` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Instagram.
    *   **Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:** –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ —Å –º–æ–±–∏–ª—å–Ω—ã–º user-agent –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏.
    *   **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫ Instagram.
    *   **Retry –ª–æ–≥–∏–∫–∞:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞—É–∑ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏.
*   **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –†–µ—à–µ–Ω–∏–µ:**
    ```typescript
    // –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ —Å cookies:
    options.push('--cookies-from-browser', 'chrome')

    // Fallback —Å –º–æ–±–∏–ª—å–Ω—ã–º user-agent:
    'Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X)'

    // –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ Instagram
    if (error.message.includes('Instagram may require login')) { ... }
    ```
*   **–†–µ–ø–µ—Ä–Ω—ã–π –ö–æ–º–º–∏—Ç:** `27dd0ef2` (–í–µ—Ç–∫–∞: `upscale`)
*   **–°–≤—è–∑–∞–Ω–Ω–∞—è –ó–∞–¥–∞—á–∞:** Instagram Reels —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑-–∑–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

---