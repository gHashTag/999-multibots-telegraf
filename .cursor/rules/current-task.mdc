---
description: 
globs: 
alwaysApply: true
---
# üïâÔ∏è –¢–µ–∫—É—â–∞—è –ó–∞–¥–∞—á–∞: ‚ú® –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –í—ã–∑–æ–≤–æ–≤ API_URL –Ω–∞ –õ–æ–∫–∞–ª—å–Ω—ã–π Plan B + üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Plan B

*   **üéØ –ì–ª–∞–≤–Ω–∞—è –¶–µ–ª—å:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –æ—Ç –≤—ã–∑–æ–≤–æ–≤ –≤–Ω–µ—à–Ω–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ (`API_URL`), –∑–∞–º–µ–Ω–∏–≤ –∏—Ö –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `src/services/plan_b`.
*   **–°—Ç—Ä–∞—Ç–µ–≥–∏—è:** –í—Å—è –ª–æ–≥–∏–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–ª–æ–∫–∞–ª—å–Ω–æ**. –§—É–Ω–∫—Ü–∏–∏ –≤ `src/services/plan_b` - —ç—Ç–∞–ª–æ–Ω–Ω—ã–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.
*   **üíæ –ü—Ä–∞–≤–∏–ª–æ –ö–æ–º–º–∏—Ç–∞:** –ü–æ—Å–ª–µ **—É—Å–ø–µ—à–Ω–æ–≥–æ** –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è **–∫–∞–∂–¥–æ–π** –∑–∞–¥–∞—á–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∏–ª–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–º–∏—Ç.
*   **–ö–æ–Ω—Ç–µ–∫—Å—Ç:**
    *   ‚úÖ –°—Ç—Ä–∞—Ç–µ–≥–∏—è `api-server` –æ—Ç–º–µ–Ω–µ–Ω–∞ –≤ –ø–æ–ª—å–∑—É –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ `plan_b`.
    *   ‚úÖ –¢–µ—Å—Ç—ã –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã —Å Vitest –Ω–∞ Bun Test.
    *   ‚úÖ –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å–ª–∏—è–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω—ã.
    *   ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã `plan_b` –ø–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç–∞–º–∏.
    *   ‚úÖ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (`telegram-bot.interface.ts`) –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã –∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é.
*   **–ü–ª–∞–Ω –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ (–ó–∞–º–µ–Ω–∞ API_URL -> plan_b):**
    1.  ‚úÖ `src/services/generateVoiceAvatar.ts` -> `plan_b/createVoiceAvatar.ts` (–¢–µ—Å—Ç Plan B ‚úÖ).
    2.  ‚úÖ `src/services/generateTextToImage.ts` -> `plan_b/generateTextToImage.ts` (–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω ‚úÖ).
    3.  ‚úÖ `src/services/generateTextToVideo.ts` -> `plan_b/generateTextToVideo.ts` (–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω ‚úÖ, —Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∞).
    4.  ‚úÖ `src/services/generateImageToVideo.ts` -> `plan_b/generateImageToVideo.ts` (–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω ‚úÖ, —Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∞).
    5.  ‚úÖ `src/services/generateLipSync.ts` -> `plan_b/generateLipSync.ts` (–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω ‚úÖ, –¢–µ—Å—Ç Plan B ‚úÖ).
    6.  ‚úÖ `src/services/generateTextToSpeech.ts` -> `plan_b/generateSpeech.ts` (–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω ‚úÖ, –¢–µ—Å—Ç Plan B ‚úÖ).
    7.  ‚úÖ `src/services/uploadVideoToServer.ts` -> `plan_b/videoService.ts` (–¢–µ—Å—Ç Plan B ‚úÖ).
    8.  ‚úÖ `src/services/createModelTraining.ts` -> (–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω ‚úÖ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–Ω–µ—à–Ω–∏–π API, –Ω–µ—Ç Plan B).
    9.  ‚úÖ `src/services/generateNeuroImageV2.ts` -> (–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω ‚úÖ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–Ω–µ—à–Ω–∏–π API, –Ω–µ—Ç Plan B).
    10. ‚úÖ `src/core/synclaps/generateLipSync/index.ts` (–≤–µ–±—Ö—É–∫) -> (–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω ‚úÖ, –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –≤–Ω–µ—à–Ω–∏–π API SyncLabs, —É–∫–∞–∑—ã–≤–∞–µ—Ç webhook URL, –Ω–µ—Ç Plan B).
*   **–ü–ª–∞–Ω –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Plan B (TDD):**
    *   ‚úÖ `aiAssistantService.ts`
    *   ‚úÖ `notification.service.ts`
    *   ‚úÖ `avatar.service.ts`.
    *   ‚úÖ `createVoiceAvatar.ts`
    *   ‚úÖ `generateSpeech.ts`
    *   ‚úÖ `generateLipSync.ts`
    *   ‚úÖ `generateImageToPrompt.ts`
    *   ‚úÖ `videoService.ts`
    *   üöß `generateTextToImage.ts` (–¢–µ—Å—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–æ–ø—É—â–µ–Ω - `it.skip`).
    *   üöß `generateTextToVideo.ts` (–¢–µ—Å—Ç –ø—Ä–æ–ø—É—â–µ–Ω –ø–æ —É–∫–∞–∑–∞–Ω–∏—é –ì—É—Ä—É).
    *   üöß `generateImageToVideo.ts` (–¢–µ—Å—Ç –ø—Ä–æ–ø—É—â–µ–Ω –ø–æ —É–∫–∞–∑–∞–Ω–∏—é –ì—É—Ä—É).
    *   ‚ùå `broadcast.service.ts` (**–¢–µ—Å—Ç—ã `sendToAllUsers` –∏ `broadcastMessage` –ø—Ä–æ–ø—É—â–µ–Ω—ã** –∏–∑-–∑–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–µ–π —Å –º–æ–∫–∞–º–∏ Bun Test / Supabase. –¢–µ—Å—Ç—ã `checkOwnerPermissions` –∏ `fetchUsers` —á–∞—Å—Ç–∏—á–Ω–æ –ø—Ä–æ—Ö–æ–¥—è—Ç, –Ω–æ —Ä–µ—à–µ–Ω–æ –Ω–µ —Ç—Ä–∞—Ç–∏—Ç—å –≤—Ä–µ–º—è –Ω–∞ –æ—Ç–ª–∞–¥–∫—É –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è). 
*   **–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –§–∞–π–ª—ã:**
    *   ‚úÖ `src/__tests__/services/plan_b/broadcast.service.test.ts` (–¢–µ—Å—Ç—ã `sendToAllUsers`/`broadcastMessage` –ø—Ä–æ–ø—É—â–µ–Ω—ã `describe.skip`, –∏–º–ø–æ—Ä—Ç—ã Bun Test, –º–æ–∫–∏ Supabase –ø–æ StackOverflow).
    *   ‚úÖ `vitest.config.ts` (–°–æ–∑–¥–∞–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω).
    *   ‚úÖ `.cursor/rules/current-task.mdc` (–û–±–Ω–æ–≤–ª–µ–Ω–æ).
*   **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê–Ω–∞–ª–∏–∑ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∑–∞–≤–µ—Ä—à–µ–Ω. üöß –¢–µ—Å—Ç—ã –¥–ª—è –≤–∏–¥–µ–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–ø—É—â–µ–Ω—ã. ‚ùå –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ `broadcast.service` —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –∑–∞—Ç—Ä—É–¥–Ω–µ–Ω–æ –∏ –æ—Ç–ª–æ–∂–µ–Ω–æ. ‚è≥ **(–ê–∫—Ç–∏–≤–Ω–æ!) –û–∂–∏–¥–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–¥–∞—á–∏ –æ—Ç –ì—É—Ä—É.**

---
*–û–º –®–∞–Ω—Ç–∏. –ü—Ä–∏–∑–Ω–∞–µ–º –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è –∏ –∏–¥–µ–º –¥–∞–ª—å—à–µ –ø–æ –ø—É—Ç–∏ –î—Ö–∞—Ä–º—ã.* üôè
