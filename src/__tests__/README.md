# –¢–µ—Å—Ç–æ–≤—ã–π –ú–æ–¥—É–ª—å: –ü—Ä–µ–π—Å–∫—É—Ä–∞–Ω—Ç –∏ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¶–µ–Ω ‚≠ê

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞—Ç—É—Å –ø–æ–∫—Ä—ã—Ç–∏—è —Ç–µ—Å—Ç–∞–º–∏ –¥–ª—è –º–æ–¥—É–ª—è —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑ —ç–∫–æ–Ω–æ–º–∏–∫–∏ —É—Å–ª—É–≥.

## üí∞ –≠–∫–æ–Ω–æ–º–∏–∫–∞ –£—Å–ª—É–≥ (–û—Ü–µ–Ω–∫–∞)

–≠—Ç–∞ —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–Ω–æ–π —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–ª–∞—Ç–Ω—ã—Ö —É—Å–ª—É–≥ –∏ –Ω–∞—à–µ–π —Ü–µ–Ω—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –†–∞—Å—á–µ—Ç–∞:**
*   `STAR_COST_USD` (–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ –ù–∞—à–µ–π –¶–µ–Ω—ã (‚≠ê) –≤ USD): $0.016
*   –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –æ—Ü–µ–Ω–∫–∞—Ö –∑–∞—Ç—Ä–∞—Ç API (Replicate, Eleven Labs, –¥—Ä.) –∏ –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å—Å—è.
*   –¶–µ–Ω—ã Replicate: [https://replicate.com/pricing](https://replicate.com/pricing)
*   –¶–µ–Ω—ã Eleven Labs (TTS): ~$0.15 / 1000 —Å–∏–º–≤–æ–ª–æ–≤ (–æ—Ü–µ–Ω–∫–∞ –ø–æ –ø–ª–∞–Ω—É Creator, [https://elevenlabs.io/pricing/api](https://elevenlabs.io/pricing/api))
*   –í—Ä–µ–º—è/—Ä–∞–∑–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏ –≤–∑—è—Ç—ã –ø—Ä–∏–º–µ—Ä–Ω–æ.
*   –ù–∞—à–∞ –¶–µ–Ω–∞ (USD) = –ù–∞—à–∞ –¶–µ–Ω–∞ (‚≠ê) * `STAR_COST_USD`
*   –ù–∞—à –ó–∞—Ä–∞–±–æ—Ç–æ–∫ (USD) = –ù–∞—à–∞ –¶–µ–Ω–∞ (USD) - –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (USD)

| –£—Å–ª—É–≥–∞ (–†–µ–∂–∏–º)                 | –ú–æ–¥–µ–ª—å/API (–ü—Ä–∏–º–µ—Ä)            | –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (USD, –ø—Ä–∏–±–ª.) | –ù–∞—à–∞ –¶–µ–Ω–∞ (‚≠ê) | –ù–∞—à–∞ –¶–µ–Ω–∞ (USD) | –ù–∞—à –ó–∞—Ä–∞–±–æ—Ç–æ–∫ (USD, –ø—Ä–∏–±–ª.) |
| :----------------------------- | :----------------------------- | :-------------------------- | :------------- | :--------------- | :--------------------------- |
| `NeuroPhoto`/`TextToImage`     | `flux-1.1-pro`                 | $0.0039 (4s @ L40S)         | 5              | $0.080           | $0.076                       |
| `NeuroPhoto`/`TextToImage`     | `flux-1.1-pro-ultra`           | $0.0039 (4s @ L40S) ?       | ?              | ?                | ?                            |
| `NeuroPhoto`/`TextToImage`     | `flux-canny-pro`               | $0.0039 (4s @ L40S) ?       | ?              | ?                | ?                            |
| `NeuroPhoto`/`TextToImage`     | `flux-depth-pro`               | $0.0039 (4s @ L40S) ?       | ?              | ?                | ?                            |
| `NeuroPhoto`/`TextToImage`     | `flux-fill-pro`                | $0.0039 (4s @ L40S) ?       | ?              | ?                | ?                            |
| `NeuroPhotoV2`                 | *–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ*                   | -                           | 14             | $0.224           | -                            |
| `VoiceToText`                  | *Whisper/AssemblyAI?*          | $0.001 (10s @ CPU)          | 4              | $0.064           | $0.063                       |
| `TextToSpeech`                 | `Eleven Labs`                  | $0.03 (200 chars @ $0.15/1k)| 3              | $0.048           | $0.012                       |
| `LipSync`                      | *Wav2Lip/SadTalker?*           | $0.0045 (20s @ T4)          | 2              | $0.032           | $0.028                       |
| `DigitalAvatarBody` (10 steps) | *–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ*                   | -                           | 93             | $1.488           | -                            |
| `DigitalAvatarBodyV2` (10 steps)| *Custom Cog Model?*            | $0.0225 (100s @ T4)         | 187            | $2.992           | $2.969                       |
| `TextToVideo`/`ImageToVideo`   | `ray-v2` (Luma)                | $0.021 (15s @ A100)         | 16             | $0.256           | $0.235                       |
| `TextToVideo`/`ImageToVideo`   | `minimax`                      | $0.021 (15s @ A100)         | 46             | $0.736           | $0.715                       |
| `TextToVideo`/`ImageToVideo`   | `haiper-video-2`               | $0.0059 (6s @ L40S) ?       | ?              | ?                | ?                            |
| `TextToVideo`/`ImageToVideo`   | `kling-v1.6-pro`               | $0.0059 (6s @ L40S) ?       | ?              | ?                | ?                            |
| `TextToVideo`/`ImageToVideo`   | `wan-2.1-i2v`/`t2v`            | $0.0135 (60s @ T4) ?        | ?              | ?                | ?                            |
| `TextToVideo`/`ImageToVideo`   | `hunyuan-video-fast`           | $0.0135 (60s @ T4) ?        | ?              | ?                | ?                            |

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è –∏ –í–æ–ø—Ä–æ—Å—ã:**
*   **–ù–µ–ø–æ–ª–Ω—ã–µ –î–∞–Ω–Ω—ã–µ:** –î–ª—è –º–Ω–æ–≥–∏—Ö –º–æ–¥–µ–ª–µ–π (–æ—Å–æ–±–µ–Ω–Ω–æ –Ω–æ–≤—ã—Ö Flux –∏ –≤–∏–¥–µ–æ-–º–æ–¥–µ–ª–µ–π) —Ü–µ–Ω–∞ –≤ –∑–≤–µ–∑–¥–∞—Ö (‚≠ê) –∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –∑–∞—Ä–∞–±–æ—Ç–æ–∫ (?) –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ —Ü–µ–Ω –∏–ª–∏ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `pricing.config.ts`. –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞/–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.
*   **–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å NeuroPhoto/V2, DigitalAvatarBody:** –¢—Ä–µ–±—É–µ—Ç—Å—è —É—Ç–æ—á–Ω–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö API/–º–æ–¥–µ–ª–µ–π –∏ –∏—Ö —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏.
*   **–û—Ü–µ–Ω–∫–∞ –ó–∞—Ç—Ä–∞—Ç:** –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –≤—Å–µ –µ—â–µ —è–≤–ª—è–µ—Ç—Å—è –æ—Ü–µ–Ω–∫–æ–π (–æ—Å–æ–±–µ–Ω–Ω–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ Replicate). –†–µ–∞–ª—å–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è.
*   **–ú–∞—Ä–∂–∞:** –í—ã—Å–æ–∫–∞—è –º–∞—Ä–∂–∞ –ø–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –ø–æ–∑–∏—Ü–∏—è–º Replicate —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, —á—Ç–æ –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –≤—ã—Å–æ–∫—É—é –∑–∞–ª–æ–∂–µ–Ω–Ω—É—é –ø—Ä–∏–±—ã–ª—å –≤ `STAR_COST_USD` ($0.016).

## üìä –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

*   **`src/price/calculator.ts`:**
    *   **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–∫—Ä—ã—Ç —é–Ω–∏—Ç-—Ç–µ—Å—Ç–∞–º–∏ (`src/__tests__/price/calculator.test.ts`).
    *   **–ü–æ–∫—Ä—ã—Ç—ã–µ –∞—Å–ø–µ–∫—Ç—ã:**
        *   –†–∞—Å—á–µ—Ç –¥–ª—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ü–µ–Ω.
        *   –†–∞—Å—á–µ—Ç –¥–ª—è —Ü–µ–Ω –ø–æ —à–∞–≥–∞–º (`steps`).
        *   –†–∞—Å—á–µ—Ç –¥–ª—è —Ü–µ–Ω –ø–æ –º–æ–¥–µ–ª—è–º (`modelId` –¥–ª—è –≤–∏–¥–µ–æ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π).
        *   –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `numImages`.
        *   –û–±—Ä–∞–±–æ—Ç–∫–∞ –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö/–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤.
        *   –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö `modelId` / `steps`.
    *   **–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:** 1 —Ç–µ—Å—Ç –Ω–∞ –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ (`vi.doMock` –Ω–µ—Å—Ç–∞–±–∏–ª–µ–Ω).
*   **`src/scenes/checkBalanceScene.ts`:**
    *   **–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (`src/__tests__/scenes/checkBalanceScene.integration.test.ts`) –≤—Ä–µ–º–µ–Ω–Ω–æ **–Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è** –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ `BOT_TOKEN_1` –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
    *   **–¢—Ä–µ–±—É–µ—Ç—Å—è:** –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `src/core/bot/index.ts` –¥–ª—è –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Telegraf –∏–ª–∏ –∏–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å `.env` –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –≤ —Ç–µ—Å—Ç–∞—Ö.
*   **–°–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ (`updateUserBalance`):**
    *   **–°—Ç–∞—Ç—É—Å:** ‚úÖ –õ–æ–≥–∏–∫–∞ –≤—ã–∑–æ–≤–∞ `updateUserBalance` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å, —Ç–∏–ø `MONEY_OUTCOME`) –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö (–∫–æ–≥–¥–∞ –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞–ª–∏).
*   **–í–æ–∑–≤—Ä–∞—Ç—ã (Refund):**
    *   **–°—Ç–∞—Ç—É—Å:** ‚ùì –ù–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–æ. –¢–µ–∫—É—â–∏–µ —Ç–µ—Å—Ç—ã –Ω–µ –ø–æ–∫—Ä—ã–≤–∞—é—Ç –ª–æ–≥–∏–∫—É –≤–æ–∑–≤—Ä–∞—Ç–æ–≤. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ç–∞–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏. 