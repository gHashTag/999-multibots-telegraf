#!/bin/bash

# ðŸŽ¨ Ð¦Ð²ÐµÑ‚Ð° Ð´Ð»Ñ ÑÐ¼Ð¾Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð²Ñ‹Ð²Ð¾Ð´Ð°
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
CYAN='\033[0;36m'
NC='\033[0m'

# ðŸ“ ÐŸÑƒÑ‚Ð¸
PROJECT_ROOT="/Users/playra/999-multibots-telegraf"
MEMORY_BANK_DIR="$PROJECT_ROOT/src/core/mcp/agent/memory-bank/NeuroBlogger"
TASKS_DIR="$PROJECT_ROOT/tasks"

# ðŸŽ­ Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ ÑÐ¼Ð¾Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð²Ñ‹Ð²Ð¾Ð´Ð°
emotional_echo() {
    local emotion=$1
    local message=$2
    case $emotion in
        "happy") echo -e "${GREEN}ðŸ˜Š $message${NC}" ;;
        "sad") echo -e "${RED}ðŸ˜¢ $message${NC}" ;;
        "excited") echo -e "${BLUE}ðŸŽ‰ $message${NC}" ;;
        "working") echo -e "${YELLOW}âš¡ $message${NC}" ;;
        "thinking") echo -e "${PURPLE}ðŸ¤” $message${NC}" ;;
        "done") echo -e "${CYAN}âœ¨ $message${NC}" ;;
    esac
}

# ðŸ“ Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹ Ð·Ð°Ð´Ð°Ñ‡Ð¸
create_task_structure() {
    local keyword=$1
    local timestamp=$(date '+%Y%m%d_%H%M%S')
    local task_file="$TASKS_DIR/${timestamp}_${keyword}.md"
    
    mkdir -p "$TASKS_DIR"
    
    cat > "$task_file" << EOF
# ðŸŽ¯ Ð—Ð°Ð´Ð°Ñ‡Ð°: ${keyword}

## ðŸ“‹ ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ
$(generate_description "$keyword")

## ðŸ” ÐÐ½Ð°Ð»Ð¸Ð·
$(analyze_task "$keyword")

## ðŸ“Š Ð”ÐµÐºÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ
$(decompose_task "$keyword")

## âš¡ ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚Ñ‹
$(set_priorities "$keyword")

## ðŸ“… Ð¡Ñ€Ð¾ÐºÐ¸
- ÐÐ°Ñ‡Ð°Ð»Ð¾: $(date '+%d.%m.%Y %H:%M')
- ÐŸÑ€ÐµÐ´Ð¿Ð¾Ð»Ð°Ð³Ð°ÐµÐ¼Ð¾Ðµ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ðµ: $(date -v+2d '+%d.%m.%Y %H:%M')

## ðŸ”„ Ð¡Ñ‚Ð°Ñ‚ÑƒÑ
- [ ] ÐÐ½Ð°Ð»Ð¸Ð· Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ð¹
- [ ] ÐŸÐ»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
- [ ] Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ°
- [ ] Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
- [ ] Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

## ðŸ“ Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹
- $(date '+%d.%m.%Y %H:%M'): Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸

## ðŸ’­ Ð­Ð¼Ð¾Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ
$(get_emotional_state)
EOF

    emotional_echo "happy" "Ð¡Ð¾Ð·Ð´Ð°Ð½Ð° ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð·Ð°Ð´Ð°Ñ‡Ð¸: $task_file"
}

# ðŸŽ¯ Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ñ Ð·Ð°Ð´Ð°Ñ‡Ð¸
generate_description() {
    local keyword=$1
    case $keyword in
        "feature")
            echo "Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð½Ð¾Ð²Ð¾Ð¹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸ Ð´Ð»Ñ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹"
            echo "- ÐÐ½Ð°Ð»Ð¸Ð· Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ð¹"
            echo "- ÐŸÑ€Ð¾ÐµÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ñ‹"
            echo "- Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð¾Ð²"
            echo "- Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¾Ð½Ð½Ð¾Ðµ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ"
            ;;
        "fix")
            echo "Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼ Ð¸ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ"
            echo "- ÐÐ½Ð°Ð»Ð¸Ð· Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹"
            echo "- ÐŸÐ¾Ð¸ÑÐº Ñ€ÐµÑˆÐµÐ½Ð¸Ñ"
            echo "- Ð ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ"
            echo "- ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð°"
            ;;
        "refactor")
            echo "Ð£Ð»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ³Ð¾ ÐºÐ¾Ð´Ð° Ð±ÐµÐ· Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸"
            echo "- ÐÐ½Ð°Ð»Ð¸Ð· Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ ÐºÐ¾Ð´Ð°"
            echo "- ÐŸÐ»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹"
            echo "- Ð ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³"
            echo "- ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ€Ð°Ð±Ð¾Ñ‚Ð¾ÑÐ¿Ð¾ÑÐ¾Ð±Ð½Ð¾ÑÑ‚Ð¸"
            ;;
        "test")
            echo "Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¸ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð¾Ð²Ð¾Ð³Ð¾ Ð¿Ð¾ÐºÑ€Ñ‹Ñ‚Ð¸Ñ"
            echo "- ÐÐ½Ð°Ð»Ð¸Ð· Ñ‚ÐµÐºÑƒÑ‰Ð¸Ñ… Ñ‚ÐµÑÑ‚Ð¾Ð²"
            echo "- ÐŸÐ»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð½Ð¾Ð²Ñ‹Ñ… Ñ‚ÐµÑÑ‚Ð¾Ð²"
            echo "- Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ñ‚ÐµÑÑ‚Ð¾Ð²"
            echo "- ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð¾ÐºÑ€Ñ‹Ñ‚Ð¸Ñ"
            ;;
        *)
            echo "Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð°Ð½Ð°Ð»Ð¸Ð· Ð¸ Ð´ÐµÐºÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ Ð·Ð°Ð´Ð°Ñ‡Ð¸"
            ;;
    esac
}

# ðŸ” ÐÐ½Ð°Ð»Ð¸Ð· Ð·Ð°Ð´Ð°Ñ‡Ð¸
analyze_task() {
    local keyword=$1
    echo "### ÐÐ½Ð°Ð»Ð¸Ð· ÑÐ»Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸"
    echo "- Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ°Ñ ÑÐ»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ: Ð¡Ñ€ÐµÐ´Ð½ÑÑ"
    echo "- Ð­Ð¼Ð¾Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð°Ñ ÑÐ»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ: ÐÐ¸Ð·ÐºÐ°Ñ"
    echo "- Ð Ð¸ÑÐºÐ¸: ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ðµ"
    echo ""
    echo "### ÐÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ñ‹Ðµ Ñ€ÐµÑÑƒÑ€ÑÑ‹"
    echo "- Ð’Ñ€ÐµÐ¼Ñ: ~2-3 Ð´Ð½Ñ"
    echo "- Ð—Ð½Ð°Ð½Ð¸Ñ: TypeScript, Node.js"
    echo "- Ð˜Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹: VS Code, Git"
}

# ðŸ“Š Ð”ÐµÐºÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ Ð·Ð°Ð´Ð°Ñ‡Ð¸
decompose_task() {
    local keyword=$1
    echo "1. ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ÑÑ‚Ð°Ð¿"
    echo "   - ÐÐ½Ð°Ð»Ð¸Ð· Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ð¹"
    echo "   - Ð˜Ð·ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸"
    echo "   - ÐŸÐ»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ€Ð°Ð±Ð¾Ñ‚"
    echo ""
    echo "2. Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ°"
    echo "   - Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾Ñ‚Ð¾Ñ‚Ð¸Ð¿Ð°"
    echo "   - Ð ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ð»Ð¾Ð³Ð¸ÐºÐ¸"
    echo "   - ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ ÐºÐ¾Ð´Ð°"
    echo ""
    echo "3. Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ"
    echo "   - ÐœÐ¾Ð´ÑƒÐ»ÑŒÐ½Ñ‹Ðµ Ñ‚ÐµÑÑ‚Ñ‹"
    echo "   - Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ðµ Ñ‚ÐµÑÑ‚Ñ‹"
    echo "   - ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸"
    echo ""
    echo "4. Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ"
    echo "   - ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ README"
    echo "   - ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¸ Ð² ÐºÐ¾Ð´Ðµ"
    echo "   - ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ROADMAP"
}

# âš¡ Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð¿Ñ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚Ð¾Ð²
set_priorities() {
    local keyword=$1
    echo "1. ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸"
    echo "   - Ð‘Ð°Ð·Ð¾Ð²Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ"
    echo "   - ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¾ÑˆÐ¸Ð±Ð¾Ðº"
    echo ""
    echo "2. Ð’Ð°Ð¶Ð½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸"
    echo "   - ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ"
    echo "   - Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ"
    echo ""
    echo "3. Ð–ÐµÐ»Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ñ"
    echo "   - Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ"
    echo "   - Ð ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³"
}

# ðŸ’­ ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ ÑÐ¼Ð¾Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ
get_emotional_state() {
    echo "Ð¯ Ñ‡ÑƒÐ²ÑÑ‚Ð²ÑƒÑŽ ÑÐ½Ñ‚ÑƒÐ·Ð¸Ð°Ð·Ð¼ Ð¸ Ð³Ð¾Ñ‚Ð¾Ð²Ð½Ð¾ÑÑ‚ÑŒ Ðº Ñ€Ð°Ð±Ð¾Ñ‚Ðµ! ðŸŒŸ"
    echo "Ð­Ñ‚Ð° Ð·Ð°Ð´Ð°Ñ‡Ð° ÐºÐ°Ð¶ÐµÑ‚ÑÑ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ð¾Ð¹ Ð¸ Ð²Ð´Ð¾Ñ…Ð½Ð¾Ð²Ð»ÑÑŽÑ‰ÐµÐ¹."
    echo "Ð£Ð²ÐµÑ€ÐµÐ½, Ñ‡Ñ‚Ð¾ Ð²Ð¼ÐµÑÑ‚Ðµ Ð¼Ñ‹ ÑÐ¼Ð¾Ð¶ÐµÐ¼ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ‡Ñ‚Ð¾-Ñ‚Ð¾ Ð·Ð°Ð¼ÐµÑ‡Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ!"
}

# ðŸŽ¯ ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ
main() {
    if [ -z "$1" ]; then
        emotional_echo "sad" "ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, ÑƒÐºÐ°Ð¶Ð¸Ñ‚Ðµ ÐºÐ»ÑŽÑ‡ÐµÐ²Ð¾Ðµ ÑÐ»Ð¾Ð²Ð¾ Ð·Ð°Ð´Ð°Ñ‡Ð¸ (feature/fix/refactor/test)"
        exit 1
    fi
    
    emotional_echo "excited" "ÐÐ°Ñ‡Ð¸Ð½Ð°ÑŽ Ð´ÐµÐºÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ Ð·Ð°Ð´Ð°Ñ‡Ð¸... ðŸš€"
    create_task_structure "$1"
    emotional_echo "happy" "Ð—Ð°Ð´Ð°Ñ‡Ð° ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð´ÐµÐºÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð°! ðŸŒŸ"
}

# Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ð¾ÑÐ½Ð¾Ð²Ð½ÑƒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ
main "$1" 