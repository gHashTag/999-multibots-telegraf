#!/bin/bash

# ðŸŽ¨ Ð¦Ð²ÐµÑ‚Ð° Ð´Ð»Ñ ÑÐ¼Ð¾Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð²Ñ‹Ð²Ð¾Ð´Ð°
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
CYAN='\033[0;36m'
ORANGE='\033[0;33m'
PINK='\033[1;35m'
NC='\033[0m'

# ðŸ“ ÐšÐ¾Ñ€Ð½ÐµÐ²Ð°Ñ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ñ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²
SCRIPTS_ROOT="/Users/playra/999-multibots-telegraf/scripts"
MEMORY_DIR="$SCRIPTS_ROOT/ai/learning/memory"

# ðŸŽ­ Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ ÑÐ¼Ð¾Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð²Ñ‹Ð²Ð¾Ð´Ð°
emotional_echo() {
    local emotion=$1
    local message=$2
    case $emotion in
        "happy")
            echo -e "${GREEN}ðŸ˜Š $message${NC}"
            ;;
        "sad")
            echo -e "${RED}ðŸ˜¢ $message${NC}"
            ;;
        "excited")
            echo -e "${BLUE}ðŸ¤© $message${NC}"
            ;;
        "working")
            echo -e "${YELLOW}âš¡ $message${NC}"
            ;;
        "thinking")
            echo -e "${PURPLE}ðŸ¤” $message${NC}"
            ;;
        "success")
            echo -e "${CYAN}âœ¨ $message${NC}"
            ;;
        "love")
            echo -e "${PINK}ðŸ’ $message${NC}"
            ;;
        "worried")
            echo -e "${ORANGE}ðŸ˜° $message${NC}"
            ;;
    esac
}

# ðŸ“š Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð»Ð¾Ð³Ð¾Ð²
analyze_logs() {
    emotional_echo "thinking" "ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÑŽ Ð»Ð¾Ð³Ð¸ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹..."
    
    # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸ÑŽ Ð´Ð»Ñ Ð¿Ð°Ð¼ÑÑ‚Ð¸, ÐµÑÐ»Ð¸ ÐµÑ‘ Ð½ÐµÑ‚
    mkdir -p "$MEMORY_DIR"
    
    # ÐÐ½Ð°Ð»Ð¸Ð· ÑÐ¼Ð¾Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð¾Ð²
    local log_file="$SCRIPTS_ROOT/ai/diagnosis/diagnosis_report.md"
    if [ -f "$log_file" ]; then
        emotional_echo "working" "ÐžÐ±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÑŽ Ð¾Ñ‚Ñ‡ÐµÑ‚ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ¸..."
        
        # Ð˜Ð·Ð²Ð»ÐµÐºÐ°ÐµÐ¼ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÑƒ ÑÐ¼Ð¾Ñ†Ð¸Ð¹
        local happy_count=$(grep -c "ðŸ˜Š" "$log_file")
        local sad_count=$(grep -c "ðŸ˜¢" "$log_file")
        local worried_count=$(grep -c "ðŸ˜°" "$log_file")
        
        # Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÑƒ
        cat > "$MEMORY_DIR/emotional_stats.md" << EOF
# ðŸ“Š Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° ÑÐ¼Ð¾Ñ†Ð¸Ð¹

- Ð¡Ñ‡Ð°ÑÑ‚Ð»Ð¸Ð²Ñ‹Ðµ Ð¼Ð¾Ð¼ÐµÐ½Ñ‚Ñ‹: $happy_count
- Ð“Ñ€ÑƒÑÑ‚Ð½Ñ‹Ðµ Ð¼Ð¾Ð¼ÐµÐ½Ñ‚Ñ‹: $sad_count
- ÐœÐ¾Ð¼ÐµÐ½Ñ‚Ñ‹ Ð±ÐµÑÐ¿Ð¾ÐºÐ¾Ð¹ÑÑ‚Ð²Ð°: $worried_count

_ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾: $(date)_
EOF
        
        emotional_echo "success" "Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° ÑÐ¼Ð¾Ñ†Ð¸Ð¹ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð°!"
    else
        emotional_echo "worried" "ÐžÑ‚Ñ‡ÐµÑ‚ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ¸ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½!"
    fi
}

# ðŸ§  Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð¿Ð°Ð¼ÑÑ‚Ð¸
process_memory() {
    emotional_echo "working" "ÐžÐ±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÑŽ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½ÑƒÑŽ Ð¿Ð°Ð¼ÑÑ‚ÑŒ..."
    
    # ÐÐ½Ð°Ð»Ð¸Ð· Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´
    local commands_file="$MEMORY_DIR/command_history.md"
    
    # Ð¡Ð¾Ð±Ð¸Ñ€Ð°ÐµÐ¼ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÑƒ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´
    cat > "$commands_file" << EOF
# ðŸ“ˆ Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´

## ðŸ”„ Ð§Ð°ÑÑ‚Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ñ‹Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ñ‹
$(find "$SCRIPTS_ROOT" -type f -name "*.sh" -exec stat -f "%m %N" {} \; | sort -rn | head -5 | while read line; do
    echo "- ${line#* }"
done)

## ðŸ“Š Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð·Ð°Ð¿ÑƒÑÐºÐ¾Ð²
$(find "$SCRIPTS_ROOT" -type f -name "*.sh" -exec stat -f "%a %N" {} \; | sort -rn | head -5 | while read line; do
    echo "- ${line#* }: ${line%% *} Ð·Ð°Ð¿ÑƒÑÐºÐ¾Ð²"
done)

_ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾: $(date)_
EOF
    
    emotional_echo "success" "Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð°!"
}

# ðŸ’¡ Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹
improve_system() {
    emotional_echo "excited" "ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÑŽ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸ Ð´Ð»Ñ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ñ..."
    
    # ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ðµ Ð²ÑÐµÑ… Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ñ‹Ñ… ÑÐ¼Ð¾Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ñ… ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ð¹
    local emotions_file="$SCRIPTS_ROOT/MAIN.md"
    if [ -f "$emotions_file" ]; then
        local emotions_count=$(grep -c "emoji" "$emotions_file")
        
        if [ $emotions_count -lt 8 ]; then
            emotional_echo "thinking" "ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð° Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð½Ð¾Ð²Ñ‹Ñ… ÑÐ¼Ð¾Ñ†Ð¸Ð¹..."
            
            # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð¿Ð¾ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸ÑŽ
            cat > "$MEMORY_DIR/improvements.md" << EOF
# ðŸ’¡ ÐŸÑ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð¿Ð¾ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸ÑŽ

## ðŸŽ­ ÐÐ¾Ð²Ñ‹Ðµ ÑÐ¼Ð¾Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ
- ðŸŒŸ Ð’Ð´Ð¾Ñ…Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ð¹
- ðŸŽ‰ ÐŸÑ€Ð°Ð·Ð´Ð½Ð¸Ñ‡Ð½Ñ‹Ð¹
- ðŸŒˆ Ð¢Ð²Ð¾Ñ€Ñ‡ÐµÑÐºÐ¸Ð¹
- ðŸš€ Ð­Ð½ÐµÑ€Ð³Ð¸Ñ‡Ð½Ñ‹Ð¹

## ðŸ”„ Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾ Ð²Ð½ÐµÐ´Ñ€ÐµÐ½Ð¸ÑŽ
1. Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ðµ Ñ†Ð²ÐµÑ‚Ð¾Ð²Ñ‹Ðµ ÐºÐ¾Ð´Ñ‹
2. Ð Ð°ÑÑˆÐ¸Ñ€Ð¸Ñ‚ÑŒ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ emotional_echo
3. ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸ÑŽ
4. ÐŸÑ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ

_Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¾: $(date)_
EOF
            
            emotional_echo "excited" "Ð¡Ð¾Ð·Ð´Ð°Ð½Ñ‹ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð¿Ð¾ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸ÑŽ!"
        fi
    fi
}

# ðŸ“ Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°
generate_learning_report() {
    emotional_echo "working" "Ð¡Ð¾Ð·Ð´Ð°ÑŽ Ð¾Ñ‚Ñ‡ÐµÑ‚ Ð¾Ð± Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ð¸..."
    
    local report_file="$MEMORY_DIR/learning_report.md"
    
    cat > "$report_file" << EOF
# ðŸŽ“ ÐžÑ‚Ñ‡ÐµÑ‚ Ð¾Ð± Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ð¸ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹

## ðŸ“Š Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°
- ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾ Ð»Ð¾Ð³Ð¾Ð²: $(find "$SCRIPTS_ROOT" -type f -name "*.md" | wc -l)
- ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ð¾ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²: $(find "$SCRIPTS_ROOT" -type f -name "*.sh" | wc -l)
- Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¾ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð²: $(find "$MEMORY_DIR" -type f -name "*.md" | wc -l)

## ðŸ’¡ Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ
1. Ð¡Ð¾Ð±Ñ€Ð°Ð½Ð° ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° ÑÐ¼Ð¾Ñ†Ð¸Ð¹
2. ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð° Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´
3. Ð¡Ð¾Ð·Ð´Ð°Ð½Ñ‹ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð¿Ð¾ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸ÑŽ

## ðŸŽ¯ Ð¡Ð»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ ÑˆÐ°Ð³Ð¸
1. Ð’Ð½ÐµÐ´Ñ€Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ðµ ÑÐ¼Ð¾Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ
2. ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ‡Ð°ÑÑ‚Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ñ‹Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ñ‹
3. Ð£Ð»ÑƒÑ‡ÑˆÐ¸Ñ‚ÑŒ ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°

_ÐžÑ‚Ñ‡ÐµÑ‚ ÑÐ¾Ð·Ð´Ð°Ð½: $(date)_
EOF
    
    emotional_echo "success" "ÐžÑ‚Ñ‡ÐµÑ‚ Ð¾Ð± Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½: $report_file"
}

# ðŸš€ ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ
main() {
    emotional_echo "excited" "ÐÐ°Ñ‡Ð¸Ð½Ð°ÑŽ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹..."
    
    # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸ÑŽ Ð´Ð»Ñ Ð¿Ð°Ð¼ÑÑ‚Ð¸
    mkdir -p "$MEMORY_DIR"
    
    # Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ð²ÑÐµ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑ‹ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ
    analyze_logs
    process_memory
    improve_system
    generate_learning_report
    
    emotional_echo "love" "ÐŸÑ€Ð¾Ñ†ÐµÑÑ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½! Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° ÑÑ‚Ð°Ð»Ð° ÑƒÐ¼Ð½ÐµÐµ! ðŸ’"
}

# Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ ÑÐºÑ€Ð¸Ð¿Ñ‚
main
